{
  "backup_info": {
    "timestamp": "2025-08-25T11:35:17.561178Z",
    "project_ref": "ucwgtiaebljfbvhokicf",
    "project_name": "CasqueEnMainV2",
    "backup_type": "complete_schema_and_data",
    "created_by": "claude_mcp_backup"
  },
  "database_schema": {
    "total_tables": 17,
    "total_views": 2,
    "total_extensions": 6,
    "total_custom_types": 4,
    "migrations_applied": 0,
    "rls_enabled": true
  },
  "tables": {
    "public.users": {
      "columns": 5,
      "primary_keys": ["id"],
      "foreign_keys": ["auth.users(id)"],
      "estimated_rows": 1,
      "rls_enabled": true
    },
    "public.profiles": {
      "columns": 13,
      "primary_keys": ["user_id"],
      "foreign_keys": ["auth.users(id)"],
      "estimated_rows": 14,
      "rls_enabled": true
    },
    "public.sessions": {
      "columns": 11,
      "primary_keys": ["id"],
      "foreign_keys": ["auth.users(id)"],
      "estimated_rows": 170,
      "rls_enabled": true
    },
    "public.session_answers": {
      "columns": 9,
      "primary_keys": ["id"],
      "foreign_keys": ["sessions(id)"],
      "estimated_rows": 161,
      "rls_enabled": true
    },
    "public.themes": {
      "columns": 5,
      "primary_keys": ["id"],
      "foreign_keys": [],
      "estimated_rows": 3,
      "rls_enabled": true
    },
    "public.sub_themes": {
      "columns": 5,
      "primary_keys": ["id"],
      "foreign_keys": ["themes(id)"],
      "estimated_rows": 18,
      "rls_enabled": true
    },
    "public.questions": {
      "columns": 10,
      "primary_keys": ["id"],
      "foreign_keys": ["sub_themes(id)"],
      "estimated_rows": 13,
      "rls_enabled": true
    },
    "public.answers": {
      "columns": 5,
      "primary_keys": ["id"],
      "foreign_keys": [],
      "estimated_rows": 0,
      "rls_enabled": true,
      "note": "Legacy table - not used in current schema"
    },
    "public.daily_challenges": {
      "columns": 6,
      "primary_keys": ["id"],
      "foreign_keys": [],
      "estimated_rows": 7,
      "rls_enabled": true
    },
    "public.user_challenges": {
      "columns": 4,
      "primary_keys": ["user_id", "challenge_id"],
      "foreign_keys": ["auth.users(id)", "daily_challenges(id)"],
      "estimated_rows": 50,
      "rls_enabled": true
    },
    "public.badges": {
      "columns": 6,
      "primary_keys": ["id"],
      "foreign_keys": [],
      "estimated_rows": 15,
      "rls_enabled": true
    },
    "public.user_badges": {
      "columns": 3,
      "primary_keys": ["user_id", "badge_id"],
      "foreign_keys": ["auth.users(id)", "badges(id)"],
      "estimated_rows": 33,
      "rls_enabled": true
    },
    "public.user_grades": {
      "columns": 4,
      "primary_keys": ["user_id", "grade_level"],
      "foreign_keys": ["auth.users(id)"],
      "estimated_rows": 30,
      "rls_enabled": true
    },
    "public.rankings": {
      "columns": 7,
      "primary_keys": ["id"],
      "foreign_keys": ["auth.users(id)"],
      "estimated_rows": 24,
      "rls_enabled": true
    },
    "public.user_stats": {
      "columns": 6,
      "primary_keys": ["user_id", "theme"],
      "foreign_keys": ["auth.users(id)"],
      "estimated_rows": 36,
      "rls_enabled": true
    },
    "public.user_question_stats": {
      "columns": 9,
      "primary_keys": ["id"],
      "foreign_keys": ["auth.users(id)"],
      "estimated_rows": 0,
      "rls_enabled": true
    },
    "public.admins": {
      "columns": 4,
      "primary_keys": ["id"],
      "foreign_keys": ["auth.users(id)"],
      "estimated_rows": 1,
      "rls_enabled": true
    }
  },
  "custom_types": {
    "session_status": {
      "type": "enum",
      "values": ["in_progress", "paused", "completed", "abandoned"]
    },
    "theme_type": {
      "type": "enum",
      "values": ["Math√©matiques", "Fran√ßais", "M√©tier"]
    },
    "badge_category": {
      "type": "enum",
      "values": ["performance", "streak", "milestone", "special"]
    },
    "ranking_type": {
      "type": "enum",
      "values": ["global", "weekly", "monthly", "theme"]
    }
  },
  "views": {
    "public.user_profiles": {
      "type": "view",
      "description": "Consolidated user profiles with email"
    },
    "public.user_admin_status": {
      "type": "view", 
      "description": "User admin status check"
    }
  },
  "installed_extensions": {
    "uuid-ossp": "1.1",
    "pgcrypto": "1.3",
    "pg_graphql": "1.5.11",
    "pg_trgm": "1.6",
    "pg_stat_statements": "1.11",
    "supabase_vault": "0.3.1"
  },
  "sample_data": {
    "themes": [
      {
        "id": "eea2ec3e-e240-4086-bc75-731e40fa96b8",
        "name": "Math√©matiques",
        "icon": "üìê"
      },
      {
        "id": "a237254e-4a45-49e7-8257-bd87d05245c9",
        "name": "Fran√ßais",
        "icon": "üìö"
      },
      {
        "id": "ed56ed4b-4ea8-444b-8e1c-e636d36318f6",
        "name": "M√©tier",
        "icon": "üöí"
      }
    ],
    "sub_themes_count": {
      "Math√©matiques": 4,
      "Fran√ßais": 4,
      "M√©tier": 10
    },
    "badges_by_category": {
      "milestone": 15,
      "performance": 0,
      "streak": 0,
      "special": 0
    }
  },
  "data_integrity": {
    "total_sessions": 170,
    "total_session_answers": 161,
    "total_questions": 13,
    "active_users": 14,
    "completed_challenges": 50
  },
  "security_config": {
    "rls_enabled_tables": 17,
    "auth_schema": "auth.users",
    "public_readable_tables": ["themes", "sub_themes", "questions", "badges"],
    "user_isolated_tables": ["profiles", "sessions", "session_answers", "user_badges", "user_stats"]
  },
  "backup_files_created": [
    "database-schema-backup-2025-08-25.md",
    "complete-data-backup-2025-08-25.sql", 
    "metadata-complete-2025-08-25.json"
  ],
  "restore_notes": [
    "Utiliser complete-data-backup-2025-08-25.sql pour restaurer la structure compl√®te",
    "Les donn√©es utilisateur sont pr√©serv√©es avec RLS activ√©",
    "Extension uuid-ossp et pgcrypto requises",
    "Sch√©ma auth.users doit exister (g√©r√© par Supabase)",
    "15 badges de grade configur√©s avec points requis"
  ]
}